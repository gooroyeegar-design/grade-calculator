<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="google-site-verification" content="7VnCPN-c_Xel-VIxwV3LicJWGOkqx8UpFrS4zFBcDYI" />
<title> Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ ØªØ®ØµØµ Ø­Ù‚ÙˆÙ‚</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
  --primary: #2563eb;
  --primary-hover: #1d4ed8;
  --bg: #f1f5f9;
  --card: #ffffff;
  --text-main: #1e293b;
  --text-muted: #64748b;
  --border: #e2e8f0;
  --success: #10b981;
  --error: #ef4444;
  --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
}

[data-theme="dark"] {
  --bg: #0f172a;
  --card: #1e293b;
  --text-main: #f8fafc;
  --text-muted: #94a3b8;
  --border: #334155;
  --primary: #3b82f6;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  font-family: 'Segoe UI', system-ui, sans-serif;
  background-color: var(--bg);
  color: var(--text-main);
  direction: rtl;
  margin: 0;
  padding: 15px;
  line-height: 1.5;
}

.container { width: 100%; max-width: 480px; margin: 0 auto; }

/* Header & Tools */
header { text-align: center; margin-bottom: 25px; margin-top: 10px; }
h1 { font-size: 1.75rem; font-weight: 800; margin: 0; color: var(--primary); }
.tagline { color: var(--text-muted); font-size: 0.9rem; }

.top-bar { display: flex; justify-content: space-between; margin-bottom: 15px; }
.icon-btn { 
  background: var(--card); border: 1px solid var(--border); 
  padding: 8px 12px; border-radius: 10px; cursor: pointer;
  color: var(--text-main); font-size: 0.85rem; font-weight: 600;
}

/* Module Card Style */
.module {
  background: var(--card);
  padding: 16px;
  margin-bottom: 16px;
  border-radius: 16px;
  border: 1px solid var(--border);
  box-shadow: var(--shadow);
  transition: transform 0.2s, border-color 0.2s;
}

.module:focus-within { border-color: var(--primary); transform: translateY(-2px); }

.module-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.module-title { font-weight: 700; font-size: 1rem; }
.coef-badge { background: var(--bg); color: var(--text-muted); padding: 2px 8px; border-radius: 6px; font-size: 0.75rem; font-weight: bold; }

/* Inputs */
.input-grid { display: flex; gap: 12px; }
.input-wrapper { flex: 1; }
label { display: block; font-size: 0.75rem; color: var(--text-muted); margin-bottom: 4px; padding-right: 4px; }

input {
  width: 100%; padding: 12px; border-radius: 10px; border: 1px solid var(--border);
  background: var(--card); color: var(--text-main); font-size: 1rem; outline: none;
  transition: all 0.2s;
}

input:focus { border-color: var(--primary); box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
input.invalid { border-color: var(--error); background: #fef2f2; }

/* Result Area */
.result-card {
  margin-top: 20px; background: var(--primary); color: white;
  padding: 24px; border-radius: 20px; text-align: center;
  box-shadow: 0 10px 25px -5px rgba(37, 99, 235, 0.4);
  display: none; animation: slideUp 0.4s ease-out;
}

@keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

.score-main { font-size: 3.5rem; font-weight: 900; line-height: 1; margin: 10px 0; }
.breakdown { font-size: 0.85rem; opacity: 0.9; margin-top: 10px; border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; }

.error-toast {
  background: var(--error); color: white; padding: 12px; border-radius: 10px;
  text-align: center; position: fixed; bottom: 20px; left: 20px; right: 20px;
  display: none; z-index: 100; font-weight: bold;
}

button.reset { background: #64748b; margin-top: 10px; opacity: 0.8; }
</style>
</head>

<body>

<div class="container">
  <div class="top-bar">
    <button class="icon-btn" onclick="toggleTheme()">ğŸŒ“ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</button>
    <button class="icon-btn" onclick="resetForm()">ğŸ”„ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
  </div>

  <header>
    <h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„</h1>
    <div class="tagline">ÙƒÙ„ÙŠØ© Ø§Ù„Ø­Ù‚ÙˆÙ‚ - Ø§Ù„Ø³Ø¯Ø§Ø³ÙŠ Ø§Ù„Ø£ÙˆÙ„</div>
  </header>

  <div id="calculator-form">
    <div class="module">
      <div class="module-header"><span class="module-title">Ù…Ø¯Ø®Ù„ Ù„Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 2</span></div>
      <div class="input-grid">
        <div class="input-wrapper"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" step="0.01" id="m1c" placeholder="00.00"></div>
        <div class="input-wrapper"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" step="0.01" id="m1t" placeholder="00.00"></div>
      </div>
    </div>

    <div class="module">
      <div class="module-header"><span class="module-title">Ù‚Ø§Ù†ÙˆÙ† Ø¯Ø³ØªÙˆØ±ÙŠ</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 2</span></div>
      <div class="input-grid">
        <div class="input-wrapper"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" step="0.01" id="m2c" placeholder="00.00"></div>
        <div class="input-wrapper"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" step="0.01" id="m2t" placeholder="00.00"></div>
      </div>
    </div>

    <div class="module">
      <div class="module-header"><span class="module-title">ØªÙ†Ø¸ÙŠÙ… Ù‚Ø¶Ø§Ø¦ÙŠ</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
      <div class="input-grid">
        <div class="input-wrapper"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" step="0.01" id="m3c" placeholder="00.00"></div>
        <div class="input-wrapper"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" step="0.01" id="m3t" placeholder="00.00"></div>
      </div>
    </div>

    <div class="module">
      <div class="module-header"><span class="module-title">Ù…Ù†Ù‡Ø¬ÙŠØ© Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
      <input type="number" step="0.01" id="m4" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ù…Ù† 20">
    </div>

    <div class="module">
      <div class="module-header"><span class="module-title">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø¸Ù…</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
      <input type="number" step="0.01" id="m5" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ù…Ù† 20">
    </div>

    <div class="module">
      <div class="module-header"><span class="module-title">Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
      <input type="number" step="0.01" id="m6" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ù…Ù† 20">
    </div>

    <div class="module" style="margin-bottom: 30px;">
      <div class="module-header"><span class="module-title">Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø¯ÙˆÙ„ÙŠ</span><span class="coef-badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
      <input type="number" step="0.01" id="m7" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ù…Ù† 20">
    </div>
  </div>

  <div class="result-card" id="resultArea">
    <div id="statusLabel" style="font-weight: 700; font-size: 1.1rem; text-transform: uppercase;">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</div>
    <div class="score-main" id="finalScore">0.00</div>
    <div id="motivationalMsg" style="font-weight: 600;"></div>
    <div class="breakdown" id="breakdown"></div>
  </div>

  <div id="errorToast" class="error-toast">âš ï¸ Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ù„Ø§Ù…Ø© 20</div>
</div>

<script>
const inputs = document.querySelectorAll('input');
const resultArea = document.getElementById('resultArea');

// 1. Auto-Calculate + Save + Validate on every keystroke
inputs.forEach(input => {
    input.addEventListener('input', () => {
        validateInput(input);
        saveData();
        calculate();
    });
});

function validateInput(el) {
    const val = parseFloat(el.value);
    const toast = document.getElementById('errorToast');
    if (val > 20) {
        el.classList.add('invalid');
        toast.style.display = 'block';
    } else {
        el.classList.remove('invalid');
        const anyErrors = Array.from(inputs).some(i => parseFloat(i.value) > 20);
        if (!anyErrors) toast.style.display = 'none';
    }
}

function saveData() {
    inputs.forEach(i => localStorage.setItem(i.id, i.value));
}

function loadData() {
    inputs.forEach(i => {
        i.value = localStorage.getItem(i.id) || "";
    });
    if (localStorage.getItem('theme') === 'dark') toggleTheme();
    calculate(); // Calculate immediately if there's saved data
}

function resetForm() {
    if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) {
        localStorage.clear();
        location.reload();
    }
}

function toggleTheme() {
    const root = document.documentElement;
    const isDark = root.getAttribute('data-theme') === 'dark';
    root.setAttribute('data-theme', isDark ? 'light' : 'dark');
    localStorage.setItem('theme', isDark ? 'light' : 'dark');
}

function calculate() {
    const getV = (id) => {
        const v = document.getElementById(id).value;
        return v === "" ? 0 : parseFloat(v);
    };

    // Check errors
    const hasError = Array.from(inputs).some(i => parseFloat(i.value) > 20);
    if (hasError) return;

    // Weights
    const m1 = (getV('m1c') * 0.6 + getV('m1t') * 0.4) * 2;
    const m2 = (getV('m2c') * 0.6 + getV('m2t') * 0.4) * 2;
    const m3 = (getV('m3c') * 0.6 + getV('m3t') * 0.4) * 1;
    const m4 = getV('m4') * 1;
    const m5 = getV('m5') * 1;
    const m6 = getV('m6') * 1;
    const m7 = getV('m7') * 1;

    const totalPoints = m1 + m2 + m3 + m4 + m5 + m6 + m7;
    const avg = totalPoints / 9;

    // Only show result if some inputs have values
    const hasValue = Array.from(inputs).some(i => i.value !== "");
    if (!hasValue) {
        resultArea.style.display = 'none';
        return;
    }

    resultArea.style.display = 'block';
    document.getElementById('finalScore').innerText = avg.toFixed(2);

    // Dynamic Messages
    const msg = document.getElementById('motivationalMsg');
    if (avg >= 10) {
        resultArea.style.background = 'var(--success)';
        msg.innerText = "sa7it yal 5abash ğŸ˜¤ğŸ”¥";
        if (avg >= 15) confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
    } else {
        resultArea.style.background = 'var(--primary)';
        msg.innerText = "ÙˆØ§ØµÙ„ Ø§Ù„Ø¹Ù…Ù„ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ÙØ¹Ù„Ù‡Ø§! ğŸ’ª";
    }

    // Breakdown Text
    document.getElementById('breakdown').innerHTML = 
        `Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‚Ø§Ø·: ${totalPoints.toFixed(2)} Ã· 9 (Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª)`;
}

window.onload = loadData;
</script>

</body>
</html>
