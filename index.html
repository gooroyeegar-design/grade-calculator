<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

<style>
:root {
  --primary: #1565c0;
  --bg: #f8f9fa;
  --card: #ffffff;
  --text: #333;
  --border: #eee;
}

[data-theme="dark"] {
  --primary: #64b5f6;
  --bg: #121212;
  --card: #1e1e1e;
  --text: #e0e0e0;
  --border: #333;
}

body {
  font-family: "Segoe UI", Tahoma, sans-serif;
  background-color: var(--bg);
  color: var(--text);
  padding: 20px;
  direction: rtl;
  transition: 0.3s;
}

.header-tools {
  display: flex;
  justify-content: space-between;
  max-width: 600px;
  margin: 0 auto 20px;
}

.theme-btn {
  background: var(--card);
  border: 1px solid var(--border);
  padding: 8px 15px;
  border-radius: 20px;
  cursor: pointer;
  color: var(--text);
}

.container { max-width: 600px; margin: auto; }

.module {
  background: var(--card);
  padding: 18px;
  margin-bottom: 15px;
  border-radius: 16px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  border: 1px solid var(--border);
}

.coef { font-size: 11px; font-weight: bold; color: var(--primary); }

.input-group { display: flex; gap: 10px; margin-top: 5px; }
input {
  width: 100%; padding: 12px; border-radius: 10px; 
  border: 2px solid var(--border); background: var(--card);
  color: var(--text); font-size: 16px;
}

button {
  width: 100%; padding: 16px; font-size: 17px;
  background: var(--primary); color: white;
  border: none; border-radius: 12px; cursor: pointer;
  font-weight: bold; margin-top: 10px;
}

.btn-share { background: #4caf50; margin-top: 10px; display: none; }

.result {
  margin-top: 25px; background: var(--card); padding: 25px;
  border-radius: 20px; text-align: center; display: none;
  border: 2px solid var(--primary);
}

.score-display { font-size: 3rem; font-weight: 800; }
.pass { color: #4caf50; }
.fail { color: #f44336; }
</style>
</head>

<body>

<div class="header-tools">
  <button class="theme-btn" onclick="toggleTheme()">ğŸŒ“ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</button>
</div>

<div class="container" id="captureArea">
  <h1>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ (/20)</h1>

  <div class="module">
    <h3>Ù…Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© (2)</h3>
    <div class="input-group">
      <input type="number" id="m1c" class="grade-input" placeholder="Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©">
      <input type="number" id="m1t" class="grade-input" placeholder="TD">
    </div>
  </div>

  <div class="module">
    <h3>Ù‚Ø§Ù†ÙˆÙ† Ø¯Ø³ØªÙˆØ±ÙŠ (2)</h3>
    <div class="input-group">
      <input type="number" id="m2c" class="grade-input" placeholder="Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©">
      <input type="number" id="m2t" class="grade-input" placeholder="TD">
    </div>
  </div>

  <div class="module">
    <h3>ØªÙ†Ø¸ÙŠÙ… Ù‚Ø¶Ø§Ø¦ÙŠ (1)</h3>
    <div class="input-group">
      <input type="number" id="m3c" class="grade-input" placeholder="Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©">
      <input type="number" id="m3t" class="grade-input" placeholder="TD">
    </div>
  </div>

  <div class="module"><h3>Ù…Ù†Ù‡Ø¬ÙŠØ© (1)</h3><input type="number" id="m4"></div>
  <div class="module"><h3>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø¸Ù… (1)</h3><input type="number" id="m5"></div>
  <div class="module"><h3>Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© (1)</h3><input type="number" id="m6"></div>
  <div class="module"><h3>Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø¯ÙˆÙ„ÙŠ (1)</h3><input type="number" id="m7"></div>

  <button onclick="calculate()">Ø§Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¹Ø¯Ù„</button>
  
  <div class="result" id="resultArea">
    <div id="statusText">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</div>
    <div id="finalScore" class="score-display">0.00</div>
    <div id="msg"></div>
  </div>
</div>

<div class="container">
    <button id="shareBtn" class="btn-share" onclick="takeScreenshot()">ğŸ“¸ Ø­ÙØ¸ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙƒØµÙˆØ±Ø©</button>
</div>

<script>
// Theme Toggle
function toggleTheme() {
    const current = document.documentElement.getAttribute('data-theme');
    const target = current === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', target);
    localStorage.setItem('theme', target);
}

// Auto-Load Data & Theme
window.onload = () => {
    document.querySelectorAll('input').forEach(i => {
        i.value = localStorage.getItem(i.id) || "";
        i.addEventListener('input', () => localStorage.setItem(i.id, i.value));
    });
    if(localStorage.getItem('theme') === 'dark') toggleTheme();
};

function calculate() {
    const getV = (id) => document.getElementById(id).value ? parseFloat(document.getElementById(id).value) : 0;
    
    const m1 = (getV("m1c")*0.6 + getV("m1t")*0.4) * 2;
    const m2 = (getV("m2c")*0.6 + getV("m2t")*0.4) * 2;
    const m3 = (getV("m3c")*0.6 + getV("m3t")*0.4) * 1;
    const rest = getV("m4") + getV("m5") + getV("m6") + getV("m7");

    const total = (m1 + m2 + m3 + rest) / 9;
    
    const resArea = document.getElementById("resultArea");
    const scoreDiv = document.getElementById("finalScore");
    
    resArea.style.display = "block";
    document.getElementById("shareBtn").style.display = "block";
    scoreDiv.innerText = total.toFixed(2);
    
    if(total >= 10) {
        scoreDiv.className = "score-display pass";
        document.getElementById("msg").innerHTML = "sa7it yal 5abash ğŸ˜¤ğŸ”¥";
    } else {
        scoreDiv.className = "score-display fail";
        document.getElementById("msg").innerHTML = "Ø±Ø§Ø³Ø¨ âŒ";
    }
}

function takeScreenshot() {
    const element = document.getElementById("captureArea");
    html2canvas(element, { backgroundColor: getComputedStyle(document.documentElement).getPropertyValue('--bg') }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'my-grades.png';
        link.href = canvas.toDataURL();
        link.click();
    });
}
</script>
</body>
</html>
