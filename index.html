  <!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="google-site-verification" content="7VnCPN-c_Xel-VIxwV3LicJWGOkqx8UpFrS4zFBcDYI" />
<title>Ø­Ø§Ø³Ø¨Ø© Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø°ÙƒÙŠØ© | Smart Grade Calc</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<style>
:root {
  --primary: #2563eb; --bg: #f8fafc; --card: #ffffff;
  --text-main: #0f172a; --text-muted: #64748b;
  --border: #e2e8f0; --success: #10b981; --accent: #8b5cf6;
  --error: #ef4444;
}
[data-theme="dark"] {
  --bg: #020617; --card: #1e293b; --text-main: #f8fafc;
  --text-muted: #94a3b8; --border: #334155; --primary: #3b82f6;
}

* { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

body {
  font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
  background-color: var(--bg); color: var(--text-main);
  direction: rtl; margin: 0; padding: 15px;
  transition: background-color 0.3s ease;
}

.container { width: 100%; max-width: 480px; margin: 0 auto; padding-bottom: 50px; }

/* Header & Controls */
.top-nav { display: flex; justify-content: space-between; margin-bottom: 20px; }
.btn-ui { 
  background: var(--card); border: 1px solid var(--border); padding: 10px 16px; 
  border-radius: 14px; cursor: pointer; color: var(--text-main); font-size: 0.85rem;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05); transition: 0.2s;
}
.btn-ui:active { transform: scale(0.95); }

/* Goal Card */
.goal-card {
  background: linear-gradient(135deg, #6366f1, #a855f7);
  color: white; padding: 24px; border-radius: 24px;
  margin-bottom: 25px; box-shadow: 0 12px 20px -5px rgba(99, 102, 241, 0.4);
}
.goal-input-group { display: flex; align-items: center; gap: 15px; margin-top: 12px; }
.goal-input-group input { 
  width: 90px; background: rgba(255,255,255,0.2); border: 2px solid rgba(255,255,255,0.3);
  color: white; text-align: center; font-weight: 800; padding: 10px; border-radius: 12px; font-size: 1.2rem;
}

/* Module Cards */
.module-card {
  background: var(--card); padding: 20px; margin-bottom: 18px;
  border-radius: 22px; border: 1px solid var(--border);
  box-shadow: 0 4px 10px -2px rgba(0,0,0,0.05);
  transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}
.module-card:focus-within { border-color: var(--primary); transform: translateY(-3px); box-shadow: 0 15px 20px -10px rgba(0,0,0,0.1); }

.card-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
.subject-name { font-weight: 700; font-size: 1.05rem; letter-spacing: -0.01em; }
.badge { background: var(--bg); padding: 4px 12px; border-radius: 10px; font-size: 0.75rem; color: var(--primary); font-weight: 800; }

.input-row { display: flex; gap: 15px; }
.field { flex: 1; }
label { display: block; font-size: 0.8rem; color: var(--text-muted); margin-bottom: 6px; font-weight: 500; }

input {
  width: 100%; padding: 14px; border-radius: 14px; border: 1.5px solid var(--border);
  background: var(--card); color: var(--text-main); font-size: 1rem; outline: none;
  transition: border-color 0.2s, box-shadow 0.2s;
}
input:focus { border-color: var(--primary); box-shadow: 0 0 0 4px rgba(37, 99, 235, 0.1); }
input.invalid { border-color: var(--error); background: rgba(239, 68, 68, 0.05); }

/* Result Box with Animation */
.result-box {
  background: var(--primary); color: white; border-radius: 28px; padding: 35px;
  text-align: center; margin-top: 30px; display: none;
  box-shadow: 0 20px 30px -10px rgba(37, 99, 235, 0.4);
}
.fade-in-up { animation: fadeInUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(30px) scale(0.95); }
  to { opacity: 1; transform: translateY(0) scale(1); }
}

.avg-number { font-size: 4.5rem; font-weight: 900; margin: 5px 0; line-height: 1; }
.target-msg { 
    background: rgba(0,0,0,0.15); padding: 15px; border-radius: 16px; 
    font-size: 0.9rem; margin-top: 20px; border-right: 5px solid white; text-align: right;
    line-height: 1.4;
}

.btn-download {
  width: 100%; background: var(--text-main); color: var(--card); border: none; padding: 18px;
  border-radius: 18px; font-weight: 800; margin-top: 20px; cursor: pointer; transition: 0.2s;
  font-size: 1rem;
}
.btn-download:active { transform: scale(0.98); }

#toast {
  position: fixed; top: 20px; left: 50%; transform: translateX(-50%);
  background: var(--error); color: white; padding: 12px 25px; border-radius: 50px;
  font-weight: bold; font-size: 0.9rem; z-index: 2000; display: none;
  box-shadow: 0 10px 20px rgba(0,0,0,0.2); animation: slideDown 0.3s ease;
}
@keyframes slideDown { from { top: -50px; } to { top: 20px; } }
</style>
</head>

<body>

<div id="toast" role="alert">âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù„Ø§Ù…Ø© Ø¨ÙŠÙ† 0 Ùˆ 20</div>

<div class="container">
  <nav class="top-nav">
    <button class="btn-ui" onclick="toggleMode()" aria-label="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">ğŸŒ“ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©</button>
    <button class="btn-ui" onclick="clearAll()" aria-label="Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª">ğŸ”„ ØªÙØ±ÙŠØº</button>
  </nav>

  <div class="goal-card">
    <div style="font-weight: 700; font-size: 1rem;">ğŸ¯ Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù…Ø±ØºÙˆØ¨</div>
    <div class="goal-input-group">
      <input type="number" id="targetGoal" value="10.00" min="0" max="20" step="0.1" aria-label="Ø§Ù„Ù‡Ø¯Ù">
      <span style="font-size: 0.9rem; opacity: 0.9; font-weight: 500;">Ø­Ø¯Ø¯ Ù‡Ø¯ÙÙƒ Ù„Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ø°ÙƒÙŠØ©</span>
    </div>
  </div>

  <div id="calculator-form">
    <div class="module-card">
      <div class="card-head"><span class="subject-name">Ù…Ø¯Ø®Ù„ Ù„Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ©</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 2</span></div>
      <div class="input-row">
        <div class="field"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" id="m1c" placeholder="0.00" min="0" max="20"></div>
        <div class="field"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" id="m1t" placeholder="0.00" min="0" max="20"></div>
      </div>
    </div>
    
    <div class="module-card">
      <div class="card-head"><span class="subject-name">Ù‚Ø§Ù†ÙˆÙ† Ø¯Ø³ØªÙˆØ±ÙŠ</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 2</span></div>
      <div class="input-row">
        <div class="field"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" id="m2c" placeholder="0.00" min="0" max="20"></div>
        <div class="field"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" id="m2t" placeholder="0.00" min="0" max="20"></div>
      </div>
    </div>

    <div class="module-card">
        <div class="card-head"><span class="subject-name">ØªÙ†Ø¸ÙŠÙ… Ù‚Ø¶Ø§Ø¦ÙŠ</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
        <div class="input-row">
          <div class="field"><label>Ù…Ø­Ø§Ø¶Ø±Ø© (60%)</label><input type="number" id="m3c" placeholder="0.00" min="0" max="20"></div>
          <div class="field"><label>Ø£Ø¹Ù…Ø§Ù„ (40%)</label><input type="number" id="m3t" placeholder="0.00" min="0" max="20"></div>
        </div>
    </div>

    <div class="module-card">
        <div class="card-head"><span class="subject-name">Ù…Ù†Ù‡Ø¬ÙŠØ©</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
        <input type="number" id="m4" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©" min="0" max="20">
    </div>

    <div class="module-card">
        <div class="card-head"><span class="subject-name">ØªØ§Ø±ÙŠØ® Ø§Ù„Ù†Ø¸Ù…</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
        <input type="number" id="m5" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©" min="0" max="20">
    </div>

    <div class="module-card">
        <div class="card-head"><span class="subject-name">Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
        <input type="number" id="m6" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©" min="0" max="20">
    </div>

    <div class="module-card">
        <div class="card-head"><span class="subject-name">Ø§Ù„Ù…Ø¬ØªÙ…Ø¹ Ø§Ù„Ø¯ÙˆÙ„ÙŠ</span> <span class="badge">Ù…Ø¹Ø§Ù…Ù„ 1</span></div>
        <input type="number" id="m7" placeholder="Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©" min="0" max="20">
    </div>
  </div>

  <div class="result-box fade-in-up" id="resBox">
    <div id="statusTxt" style="font-weight:800; font-size: 1.1rem; letter-spacing: 0.05em;">Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ</div>
    <div class="avg-number" id="avgOut">0.00</div>
    <div id="targetPrediction" class="target-msg" style="display:none;"></div>
  </div>

  <button class="btn-download" id="downloadBtn" onclick="downloadReport()" style="display:none;">ğŸ“¥ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ø®Øµ Ø§Ù„Ø¯Ø±Ø¬Ø§Øª (TXT)</button>
</div>

<script>
const inputs = document.querySelectorAll('input');
const toast = document.getElementById('toast');
let reportText = "";

window.onload = () => {
    inputs.forEach(i => i.value = localStorage.getItem(i.id) || i.value);
    if(localStorage.getItem('theme') === 'dark') toggleMode();
    calculate(false);
};

inputs.forEach(input => {
    input.addEventListener('input', () => {
        const val = parseFloat(input.value);
        if(val > 20 || val < 0) {
            input.classList.add('invalid');
            toast.style.display = 'block';
        } else {
            input.classList.remove('invalid');
            if(!document.querySelector('.invalid')) toast.style.display = 'none';
        }
        localStorage.setItem(input.id, input.value);
        calculate(true);
    });
});

function calculate(isLive) {
    const getV = (id) => {
        const val = document.getElementById(id).value;
        return (val === "" || isNaN(val)) ? null : parseFloat(val);
    };

    const modules = [
        { name: "Ù…Ø¯Ø®Ù„ Ù‚Ø§Ù†ÙˆÙ†", val: (getV('m1c') !== null && getV('m1t') !== null) ? (getV('m1c')*0.6 + getV('m1t')*0.4) : null, coef: 2 },
        { name: "Ø¯Ø³ØªÙˆØ±ÙŠ", val: (getV('m2c') !== null && getV('m2t') !== null) ? (getV('m2c')*0.6 + getV('m2t')*0.4) : null, coef: 2 },
        { name: "ØªÙ†Ø¸ÙŠÙ… Ù‚Ø¶Ø§Ø¦ÙŠ", val: (getV('m3c') !== null && getV('m3t') !== null) ? (getV('m3c')*0.6 + getV('m3t')*0.4) : null, coef: 1 },
        { name: "Ù…Ù†Ù‡Ø¬ÙŠØ©", val: getV('m4'), coef: 1 },
        { name: "ØªØ§Ø±ÙŠØ® Ù†Ø¸Ù…", val: getV('m5'), coef: 1 },
        { name: "Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", val: getV('m6'), coef: 1 },
        { name: "Ù…Ø¬ØªÙ…Ø¹ Ø¯ÙˆÙ„ÙŠ", val: getV('m7'), coef: 1 }
    ];

    let totalPoints = 0, filledCoefs = 0, missingCoefs = 0;
    modules.forEach(m => {
        if(m.val !== null) { totalPoints += (m.val * m.coef); filledCoefs += m.coef; }
        else { missingCoefs += m.coef; }
    });

    const totalCoefficients = 9;
    const finalAvg = (totalPoints / totalCoefficients).toFixed(2);
    const resBox = document.getElementById('resBox');
    const dlBtn = document.getElementById('downloadBtn');
    
    if(filledCoefs === 0) { resBox.style.display = 'none'; dlBtn.style.display = 'none'; return; }
    
    if(resBox.style.display === 'none') {
        resBox.style.display = 'block';
        resBox.classList.add('fade-in-up');
    }
    
    dlBtn.style.display = 'block';
    document.getElementById('avgOut').innerText = finalAvg;

    const goal = parseFloat(document.getElementById('targetGoal').value) || 10;
    const predictDiv = document.getElementById('targetPrediction');
    let strategyTxt = "";

    if(missingCoefs > 0) {
        const needed = ((goal * totalCoefficients) - totalPoints) / missingCoefs;
        predictDiv.style.display = 'block';
        if(needed <= 0) strategyTxt = "Ù„Ù‚Ø¯ ØªØ¬Ø§ÙˆØ²Øª Ù‡Ø¯ÙÙƒ Ø¨Ø§Ù„ÙØ¹Ù„! ÙˆØ§ØµÙ„ Ù„Ø±ÙØ¹ Ù…Ø¹Ø¯Ù„Ùƒ Ù„Ù„Ø£Ø¹Ù„Ù‰. âœ¨";
        else if(needed > 20) strategyTxt = "Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ù‡Ø°Ø§ Ø§Ù„Ù‡Ø¯Ù ÙŠØªØ·Ù„Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† 20 ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©. Ø±ÙƒØ² Ø¹Ù„Ù‰ ØªÙ‚Ù„ÙŠØµ Ø§Ù„ÙØ¬ÙˆØ©! ğŸš©";
        else strategyTxt = `Ù„ØªØ­Ù‚ÙŠÙ‚ Ù‡Ø¯ÙÙƒ (${goal})ØŒ ØªØ­ØªØ§Ø¬ Ù„Ù…Ø¹Ø¯Ù„ ${needed.toFixed(2)} ÙÙŠ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©.`;
    } else {
        predictDiv.style.display = 'none';
        if(parseFloat(finalAvg) >= goal && isLive) confetti({ particleCount: 40, spread: 70, origin: { y: 0.8 } });
    }
    predictDiv.innerText = strategyTxt;

    reportText = `ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠ\n====================\n`;
    reportText += `Ø§Ù„Ù…Ø¹Ø¯Ù„ Ø§Ù„Ø­Ø§Ù„ÙŠ: ${finalAvg} / 20\nØ§Ù„Ù‡Ø¯Ù Ø§Ù„Ù…Ø®Ø·Ø· Ù„Ù‡: ${goal}\n`;
    if(strategyTxt) reportText += `ØªÙˆÙ‚Ø¹Ø§Øª Ø§Ù„Ù†Ø¬Ø§Ø­: ${strategyTxt}\n`;
    reportText += `====================\nØ§Ù„ØªØ§Ø±ÙŠØ®: ${new Date().toLocaleDateString('ar-DZ')}`;
}

function downloadReport() {
    const blob = new Blob([reportText], { type: "text/plain;charset=utf-8" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = "MyGradeReport.txt";
    link.click();
}

function toggleMode() {
    const root = document.documentElement;
    const isDark = root.getAttribute('data-theme') === 'dark';
    root.setAttribute('data-theme', isDark ? 'light' : 'dark');
    localStorage.setItem('theme', isDark ? 'light' : 'dark');
}

function clearAll() { if(confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø±ØºØ¨ØªÙƒ ÙÙŠ Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) { localStorage.clear(); location.reload(); } }
</script>
</body>
</html>
